# Vim

## 1. Зачем он вообще нужен ?

Здесь должно было быть много текста, 
на тему того что Vim вряд ли вам нужен,
если вы не фанат консоли, и даже если фанат консоли,
все равно не нужен  (для базовых штук может хватить nano),
а если у вас все и так нормально работает, т.е есть привычные 
для вас IDE и легкие редакторы 
(какой-нибудь Sublime Text для мелочи типа \*.txt, \*json),
тогда тем более Vim не нужон.

Объективных плюсов Vim вижу 3: 
1. можно использовать из терминала
(отредактировал, вышел, комит-пуш сделал)
2. он очень быстрый и из него можно сделать подобие mini-IDE, 
но придется возиться с настройками <br>
(выход для тех у кого слабый комп? возможно, не уверен)
3. под него пишут много плагинов, 
потому что он чудом остается популярным

Но если эти плюсы вам кажутся смешными, то я с вами даже согласен. <br>
Но тогда вам эти заметки не нужны, а заметки для тех кто привык юзать Vim.

## 2. Основы

В Vim большой акцент сделан на режимы и команды.

Основных режима два: нормальный (**normal** mode) 
и режим вставки (**insert** mode). <br>
Нормальный режим часто называют командным режимом, <br>
но в этой заметке командный режим будет 
считаться разновидностью нормального.

При открытии файла (команда `vim имя-файла`)
Vim находится в нормальном режиме. <br>
В нормальном режиме любое нажатие воспринимается 
как набор команды, а не как ввод текста. <br>
Чтобы перейти в режим вставки нужно просто нажать `i`.
И тогда можно вводить текст. <br>
Скорее всего (99.99%) ваш Vim из коробки не дружит с другими языками, <br>
потому важно переключиться на английский язык,
чтобы набрать именно английскую `i`.

Команды в Vim выполняются из нормального режима. <br>
Чтобы вернуться в нормальный режим, нужно нажать `Esc`. <br>
Если Vim уже находится в нормальном режиме,
то нажатие `Esc` ничего не изменит.

В Vim команды бывают двух видов.

1. Команды, которые начинаются с символа `:`, `/`, `?`. <br>
При наборе одного из этих символов,
Vim переходит в командный режим (**command** mode). <br>
Такие команды видно в нижней строке слева.
Для выполнения команды нужно нажать `Enter`. <br>
Например, чтобы выйти из Vim сохранив файл, <br>
нужно, находясь в нормальном режиме,
набрать `:wq` и нажать `Enter`. <br>
Чтобы выйти из Vim, не сохраняя сделанные изменения, нужно <br>
(находясь в нормальном режиме!) набрать `:q!` и нажать `Enter`.

2. Остальные команды выполняются сразу же после того как набраны. <br>
Например, командой `u` можно отменить последнее действие. <br>
Команда `dd` удалит активную строку (ту на которой находится курсор ). <br>

Режимы Vim

|  Команда | Режим                 | На английском     |
|:--------:|-----------------------|-------------------|
|    Esc   | нормальный режим      | normal mode       |
|     i    | режим вставки         | insert mode       |
|     R    | режим замены          | replace mode      |
|     v    | режим выделения       | visual mode       |
|     V    | режим выделения строк | visual line mode  |
| Ctrl + V | режим выделения блока | visual block mode |

Способы перехода в нормальный режим

1) Esc
2) Ctrl + C
3) Ctrl + [

## 3. Базовые команды

|   Команда      | Действие                         | Расшифровка          |
|:--------------:|----------------------------------|----------------------|
|     `:help`    | справка                          | **help**             |
|     `:w`       | сохранить                        | **w**rite            |
|   `:w <file>`  | сохранить в новый файл           | **w**rite            |
|      `:q`      | выйти                            | **q**uit             |
|      `:q!`     | выйти без сохранения             | **q**uit             |
| `:wq` или `ZZ` | сохранить и выйти                | **w**rite & **q**uit |
|    `:e file`   | открыть другой файл              | **e**dit             |
|    `:e! file`  | (закрыть текущий без сохранения) | **e**dit             |
|     `:e!`      | отменить все изменения           | **e**dit             |
|       `u`      | отменить последнее действие      | **u**ndo             |
|    `Ctrl + R`  | повторить отмененное действие    | **r**edo             |
|       `v`      | начать выделение                 | **v**isual mode      |
|       `y`      | копировать выделенное            | **y**ank             |
|       `p`      | вставить после курсора           | **p**aste            |
|       `x`      | удалить символ                   | крестик :)           |
|       `dd`     | удалить строку                   | **d**elete           |
|       `d`      | удалить выделенное               | **d**elete           |

## 4. Перемещение по тексту

В Vim поддерживается навигация стрелочками, <br>
но вместо них также можно использовать (в нормальном режиме) hjkl (← ↓ ↑ →).

|   Команда   | Действие                         | Расшифровка                |
|:-----------:|----------------------------------|----------------------------|
|     `gg`    | перейти к первой строке          | **g**o                     |
|     `G`     | перейти к последней строке       | **g**o                     |
|  `<num>gg`  | перейти к строке с номером       | **g**o                     |
|  `<num>G`   | перейти к строке с номером       | **g**o                     |
|     `gd`    | перейти к определению (сущности) | **g**oto to **d**efinition |
|     `gf`    | перейти к файлу под курсором     | **g**oto to **f**ile       |
|   Ctrl + O  | перейти назад (пред. файл)       |                            |
| `[[` / `[{` | перейти в начало функции         |                            |
|     `]}`    | перейти в  конец функции         |                            |
|     `0`     | перейти в начало строки          | массивы с 0 начинаются :)  |
|     `$`     | перейти в конец строки           | также как в regexp         |
|     `e`     | перейти в конец слова            | **e**nd                    |
|     `w`     | перейти к следующему слову       | **w**ord                   |
|     `b`     | перейти к предыдущему слову      | **b**ack                   |
|     `%`     | перейти к соответствующей скобке |                            |
|     `+`     | первый символ следующей строки   |                            |
|     `-`     | первый символ предыдущей строки  |                            |
|   Ctrl + F  | на одну страницу вниз            | **f**orward                |
|   Ctrl + B  | на одну страницу вверх           | **b**ackward               |
|   Ctrl + D  | на пол-страницы вниз             | **d**own                   |
|   Ctrl + U  | на пол-страницы вверх            | **u**p                     |

Навигация с помощью меток

`mx` создать метку x (любой символ)

`mX` создать глобальную метку

`'x` перейти к месту помеченному x

## 5. Удаление

Следующие команды, удаляют текст оставляя Vim в нормальном режиме. <br>
Эти команды могут использоваться не только для того чтобы удалить текст, <br>
но и для того чтобы вырезать его и вставить в другом месте с помощью `p` (**p**aste)

Команды `di"`, `da"` работают с любыми парными символами (скобки, кавычки и.т.д).

| Команда | Действие                    | Расшифровка                |
|:-------:|-----------------------------|----------------------------|
|   `x`   | удалить символ              | крестик :)                 |
|  `di"`  | удалить внутри кавычек      | **d**elete **i**n **"**    |
|  `da"`  | удалить вместе с кавычками  | **d**elete **a**ll (?)     |
|  `diw`  | удалить все слово           | **d**elete **i**n **w**ord |
|  `dtX`  | удалить до символа X        | **d**elete **t**ill        |
|  `dfX`  | удалить вместе с символом X | **d**elete **f**ind        |
|   `dw`  | удалить до конца слова      | **d**elete **w**ord        |
|   `dd`  | удалить строку              | **d**elete                 |
|   `d0`  | удалить до начала строки    | массивы с 0 начинаются :)  |
|   `d$`  | удалить до конца строки     | $ также как в regexp       |
|   `D`   | удалить до конца строки     |                            |

## 6. Изменение

Команды начинающиеся на d(из таблицы выше) имеют аналоги, начинающиеся на c (**c**hange). <br>
Работают точно также, но переводят Vim в режим вставки, чтобы можно было изменить часть текста. <br>
Аналогом команды `cc` является команда `dd`, аналогом команды `D` -- команда `C`.

Кроме того есть команда `rx`, которая заменяет <br>
символ под курсором на x (вместо `x` может быть любой символ) <br>
и специальный режим замены, который устанавливается командой `R`, <br>
в этом режиме текст вводится поверх существующего. Для завершения нужно нажать `Esc`.

## 7. Копирование и вставка

Команды `yi"`, `yiw`, `yw`, `y0`, `y$` и.т.д работают также как аналогичные команды,
<br> начинающиеся на d, только вместо удаления они копируют нужную часть текста.

После выполнения команды `v` выделение
можно расширять стрелочками или с помощью hjkl.
Чтобы снять выделение нужно нажать `Esc`.
Существуют также команды `vi"`, `va"`, `vw` и.т.д,
работают также как описано выше, только используются для выделения.

| Команда | Действие                          | Расшифровка |
|:-------:|-----------------------------------|-------------|
|   `v`   | начать выделение (Esc - отменить) | **v**isual  |
|   `p`   | вставить после курсора            | **p**aste   |
|   `P`   | вставить перед курсором           | **p**paste  |
|   `y`   | копировать                        | **y**ank    |

## 8. Добавление текста

Следующие команды переводят Vim в режим вставки.

| Команда | Действие                       | Расшифровка |
|:-------:|--------------------------------|-------------|
|   `o`   | добавить строку ниже           |             |
|   `O`   | добавить строку выше           |             |
|   `i`   | добавить текст перед курсором  | **i**nsert  |
|   `a`   | добавить текст после курсора   | **a**ppend  |
|   `I`   | добавить текст в начало строки | **i**nsert  |
|   `A`   | добавить текст в конец строки  | **a**ppend  |


## 9. Поиск и замена
|        Команда        | Действие                                      |
|:---------------------:|:----------------------------------------------|
|        `/text`        | поиск                                         |
|        `?text`        | поиск в обратном направлении                  |
|          `n`          | следующее совпадение                          |
|          `N`          | предыдущее совпадение                         |
|         `:noh`        | отключить подсветку (**no h**ighlight)        |
|          `/`          | повторить поиск                               |
|          `?`          | повторить поиск в обратном направлении        |
|      `:s/old/new`     | заменить первое вхождение в строке            |
|     `:s/old/new/g`    | заменить все вхождения в строке               |
|    `:%s/old/new/g`    | заменить все вхождения во всем файле          |
|   `:F,Ls/old/new/g`   | заменить все вхождения в строках от F до L    |
| `:<smth>s/old/new/gc` | заменить с потверждением каждой замены        |
|          `*`          | найти слово под курсором                      |
|          `#`          | найти слово под курсором (в обр. направлении) |
|          `tX`         | символ перед следующим вхождением X           |
|          `fX`         | следующее вхождение символа X в строке        |
|          `FX`         | предыдущее вхождение символа X в строке       |

## 10. Работа с несколькими файлами

### Открыть несколько файлов

`vim -p file1 file2...`  создать вкладку для каждого файла

`vim -O file1 file2...`  создать окно для каждого файла (вертикально)

`vim -o file1 file2...`  создать окно для каждого файла (горизонтально)

### Сохранение и выход

|      Команда       | Действие                         |
|:------------------:|:---------------------------------|
|  `:qa` или `qall`  | закрыть все файлы                |
| `:qa!` или `qall!` | закрыть все файлы без сохранения |
|      `:wall`       | сохранить все                    |
|      `:wqall`      | выйти и сохранить все файлы      |
|      `:qall!`      | выйти без сохранения изменений   |

### Работа с вкладками

|         Команда        | Действие                           |
|:----------------------:|:-----------------------------------|
|       `:tabe file`     | создать новую вкладку              |
|      `:tabnew file`    | создать новую вкладку              |
|     `:tabedit file`    | создать новую вкладку              |
|      `:tabclose`       | закрыть вкладку                    |
|       `:tabonly`       | закрыть остальные вкладки          |
| `gt` / `Ctrl + PgDown` | следующая вкладка                  |
| `gT` / `Ctrl + PgUp`   | предыдущая вкладка                 |
|       `:tabmove`       | переместить вкладку в конец        |
|     `:tabmove num`     | переместить вкладку на позицию num |

### Работа с окнами

|      Команда       | Действие                         |
|:------------------:|----------------------------------|
|       `:only`      | закрыть все окна кроме активного |
|    `:windo cmd`    | выполнить команду для всех окон  |
| `:split filename`  | открыть файл в нижнем окне       |
| `:vsplit filename` | открыть файл в правом окне       |
|  `Ctrl + W, Arrow` | переместиться в нужное окно      |
|    `Ctrl + W, x`   | поменять окна местами            |
|    `Ctrl + W, q`   | закрыть окно                     |
|     Ctrl + W, \|   | сделать окно максимальной ширины |
|    `Ctrl + W, _`   | сделать окно максимальной высоты |
|    `Ctrl + W, =`   | сделать окна равной ширины       |
|    `Ctrl + W, K`   | сделать текущее окно верхним     |
|    `Ctrl + W, J`   | сделать текущее окно нижним      |
|    `Ctrl + W, H`   | сделать текущее окно левым       |
|    `Ctrl + W, L`   | сделать текущее окно правым      |
|    `Ctrl + W, >`   | увеличить ширину окна            |

## 11. Разное

`num<cmd>`         повторить команду num раз

`<<`               сдвиг на один отступ влево

`>>`               сдвиг на один отступ вправо

`:!cmd`            запуск внешней команды (например ls)

`:.!cmd`           вставить вывод команды

`:term bash`       открыть окно с терминалом

`Ctrl + Z`         приостановить Vim (вернуться - fg)

`Ctrl + ]`         перейти по тегу

### Разные команды для работы с текстом

|    Команда   | Действие                                       |
|:------------:|:-----------------------------------------------|
|      `J`     | объединить строку со строкой ниже              |
|      `U`     | изменить регистр букв на верхний (visual mode) |
|      `u`     | изменить регистр букв на нижний  (visual mode) |
|      `~`     | изменить регистр букв на противоположный       |
| `g Ctrl + G` | показать кол-во слов                           |
|  `Ctrl + A`  | увеличить число на 1                           |
|  `Ctrl + X`  | уменьшить число на 1                           |

### Настройки Vim

|       Команда        | Действие                                 |
|:--------------------:|:-----------------------------------------|
|    `:source file`    | загрузить конфигурацию Vim из файла      |
|     `:set option`    | установить опцию                         |
|   `:set no<option>`  | удалить опцию                            |
| `:colorscheme scheme`| установить тему                          |
|     `:set number`    | показывать номера строк                  |

